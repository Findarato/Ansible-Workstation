---
# Install Flatpak to ensure that it works
- name:       ğŸ“¦ Install Flatpak
  package:
    name:     flatpak
    state:    present
  become:     yes


# This is giving me issues
- name: Add the flathub flatpak repository remote to the user installation
  become: true
  flatpak_remote:
    name: flathub
    state: present
    flatpakrepo_url: https://dl.flathub.org/repo/flathub.flatpakrepo


- name: ğŸ“¦ Install Flathub Flatpak Packages
  flatpak:
    name:   "{{ flatpak_install }}"
    state:  present
    remote: flathub
  with_items:
    - com.mattjakeman.ExtensionManager
    - me.kozec.syncthingtk
    - org.gimp.GIMP
    - com.getferdi.Ferd
    - io.github.celluloid_player.Celluloid
    - io.github.peazip.PeaZip
    - re.sonny.Commit
  loop_control:
    loop_var:         flatpak_install
  tags:
    - flatpak
    - packages

- name: ğŸ“¦ Install Flatpak -> Bitwarden
  flatpak:
    name:   com.bitwarden.desktop
    state:  present
    remote: flathub
  tags:
    - flatpak
    - packages
  when:
    - install_bitwarden is true


...